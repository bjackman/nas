# TODO: Update regularly
# TODO: Must create filebrowser.db, how to avoid?

services:
  # docs say:
  # docker run \
      # -v /path/to/root:/srv \
      # -v /path/filebrowser.db:/database.db \
      # -v /path/.filebrowser.json:/.filebrowser.json \
      # -u $(id -u):$(id -g) \
      # -p 8080:80 \
      #
  file_browser:
    image: docker.io/filebrowser/filebrowser
    volumes:
      - "data:/srv"
      - type: bind
        source: ./filebrowser.db
        target: /database.db
        external: true
    networks:
      - nas
  # docs say:
  # docker run -d -p 8080:8080 -p 80:80 \
  #  -v $PWD/traefik.yml:/etc/traefik/traefik.yml traefik:v3.3
  traefik:
    image: docker.io/traefik:v3.3
    ports: "8080:80"
    command: traefik --configFile=/traefik.yaml
    networks:
      - nas
    configs:
      - name: "traefik.yaml"
        content: |
          # Empty config

volumes:
  # The actual NAS filesystem. Will probably be ZFS.
  data:

networks:
  nas:
    name: nas